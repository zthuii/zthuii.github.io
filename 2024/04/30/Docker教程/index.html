<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Docker教程 | WaitAyaka</title><meta name="author" content="WaitAyaka"><meta name="copyright" content="WaitAyaka"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="referrer" content="no-referrer"><meta name="description" content="*DockerDocker为什么会出现？ 一款产品：开发—上线 两套环境！应用环境，应用配置！  开发  —-  运维   问题：我在我的电脑上可以运行！版本更新，导致服务不可用！对于运维来说，考验就十分大？ 开发即运维 环境配置十分麻烦，每一个机器都要部署环境（集群Redis，ES，Hadoop……），费时费力。  那么项目能不能带上环境一起安装呢  Docker通过隔离机制，可以将服务器利用到">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker教程">
<meta property="og:url" content="https://waitayaka.github.io/2024/04/30/Docker%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="WaitAyaka">
<meta property="og:description" content="*DockerDocker为什么会出现？ 一款产品：开发—上线 两套环境！应用环境，应用配置！  开发  —-  运维   问题：我在我的电脑上可以运行！版本更新，导致服务不可用！对于运维来说，考验就十分大？ 开发即运维 环境配置十分麻烦，每一个机器都要部署环境（集群Redis，ES，Hadoop……），费时费力。  那么项目能不能带上环境一起安装呢  Docker通过隔离机制，可以将服务器利用到">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://waitayaka.github.io/img/docker.jpg">
<meta property="article:published_time" content="2024-04-30T06:48:51.000Z">
<meta property="article:modified_time" content="2024-04-30T07:02:14.515Z">
<meta property="article:author" content="WaitAyaka">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="Kubernetes">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://waitayaka.github.io/img/docker.jpg"><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="https://waitayaka.github.io/2024/04/30/Docker%E6%95%99%E7%A8%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":30,"languages":{"author":"作者: WaitAyaka","link":"链接: ","source":"来源: WaitAyaka","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Docker教程',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-30 15:02:14'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2264842_b004iy0kk2b.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">10</div></a><a href="/Tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/Categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时光机</span></a></div><div class="menus_item"><a class="site-page" href="/Tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/Categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment"><i class="fa-fw fas fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/docker.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">WaitAyaka</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时光机</span></a></div><div class="menus_item"><a class="site-page" href="/Tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/Categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment"><i class="fa-fw fas fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Docker教程</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-04-30T06:48:51.000Z" title="发表于 2024-04-30 14:48:51">2024-04-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-30T07:02:14.515Z" title="更新于 2024-04-30 15:02:14">2024-04-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/Categories/Docker/">Docker</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>46分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title="Docker教程"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2024/04/30/Docker%E6%95%99%E7%A8%8B/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Docker"><a href="#Docker" class="headerlink" title="*Docker"></a>*Docker</h1><h2 id="Docker为什么会出现？"><a href="#Docker为什么会出现？" class="headerlink" title="Docker为什么会出现？"></a>Docker为什么会出现？</h2><blockquote>
<p>一款产品：开发—上线 两套环境！应用环境，应用配置！</p>
</blockquote>
<p>开发  —-  运维   问题：我在我的电脑上可以运行！版本更新，导致服务不可用！对于运维来说，考验就十分大？</p>
<p>开发即运维</p>
<p>环境配置十分麻烦，每一个机器都要部署环境（集群Redis，ES，Hadoop……），费时费力。</p>
<blockquote>
<p>那么项目能不能带上环境一起安装呢</p>
</blockquote>
<p>Docker通过隔离机制，可以将服务器利用到极致</p>
<p>本质：所有的技术因为出现了一些问题，我们需要去解决，才去学习。</p>
<h2 id="Docker的历史"><a href="#Docker的历史" class="headerlink" title="Docker的历史"></a>Docker的历史</h2><p>2010年，几个搞IT的年轻人，就在美国成立了一家公司 <code>dotCloud</code>做一些pass的云计算服务！</p>
<p>我们将自己的技术（容器化技术）命名 就是docker！</p>
<p>Docker刚刚诞生的时候，没有引起行业的注意！</p>
<blockquote>
<p>开源</p>
</blockquote>
<p>开发源代码</p>
<p>2013年，Docker开源</p>
<p>Docker越来越多的人发现了Docker的优点，Docker每个月都会更新一个版本</p>
<p>2014年四月，Docker1.0发布</p>
<p>Docker为什么这么火呢，因为它相对于一个虚拟机来说，它非常轻。</p>
<ul>
<li>在容器技术出来之前，我们都是使用的虚拟机技术。<ul>
<li>虚拟机：创建一个操作系统非常的笨重  内存占用大</li>
<li>Docker： 内存占用下 启动快 只需要运行一个软件即可</li>
</ul>
</li>
</ul>
<p>到现在，所有开发人员都必须会docker！</p>
<blockquote>
<p>聊聊Docker</p>
</blockquote>
<p>Docker是基于Go语言开发的·！开源项目！</p>
<p>官网： <a target="_blank" rel="noopener" href="https://www.docker.com/">https://www.docker.com/</a></p>
<p>文档： <a target="_blank" rel="noopener" href="https://docs.docker.com/">https://docs.docker.com/</a></p>
<h2 id="Docker能干嘛"><a href="#Docker能干嘛" class="headerlink" title="Docker能干嘛"></a>Docker能干嘛</h2><ul>
<li>之前的虚拟机技术<ul>
<li>1、 资源占用十分多</li>
<li>冗余步骤多</li>
<li>启动很慢</li>
</ul>
</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/WaitAyaka/wait-ayaka-pictures/raw/master/image-20231206090521553.png" alt="image-20231206090521553"></p>
<ul>
<li>容器化技术</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206090703349.png" alt="image-20231206090703349"></p>
<blockquote>
<p>比较Docker和虚拟机技术的不同：</p>
</blockquote>
<ul>
<li>传统虚拟机。虚拟出一条硬件，运行一个完整的操作系统，憨厚在这个系统上安装和运行软件</li>
<li>容器内的应用直接运行在宿主机的内容，容器是没有自己的内核的，也没有虚拟我们的硬件，所以就轻便了。</li>
<li>每个容器间时互相隔离，每个容器内都有一个属于自己的文件系统，互不影响。</li>
</ul>
<h2 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h2><h3 id="Docker的基本组成"><a href="#Docker的基本组成" class="headerlink" title="Docker的基本组成"></a>Docker的基本组成</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="images/15.png" alt="15"></p>
<p><strong>镜像 （Image）:</strong></p>
<p>docker镜像就好比是一个模板，开源通过这个模板来创建容器服务，romcat镜像—run—tomcat01容器（提供服务器），通过这个镜像可以创建多个容器。</p>
<p><strong>容器（container）：</strong></p>
<p>Docker利用容器技术：独立运行一个或者一个组应用，通过镜像来创建的。</p>
<p>启动、停止、删除、基本命令！</p>
<p>目前可以把容器给i理解为就是一个简易的Linux系统</p>
<p><strong>仓库 （repository）：</strong></p>
<p>仓库就是存放镜像的地方！</p>
<p>仓库分为共有仓库和私有仓库！</p>
<p>Docker Hub （默认是国外的）</p>
<p>阿里云..都有容器服务 </p>
<h3 id="安装Docker-（网络源）"><a href="#安装Docker-（网络源）" class="headerlink" title="安装Docker （网络源）"></a>安装Docker （网络源）</h3><blockquote>
<p>环境查看</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">系统内核要是3.0以上的</span></span><br><span class="line">[root@k8s ~]# uname -r</span><br><span class="line">5.14.0-162.6.1.el9_1.0.1.x86_64</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">系统版本</span></span><br><span class="line">[root@k8s ~]# cat /etc/os-release </span><br><span class="line">NAME=&quot;Rocky Linux&quot;</span><br><span class="line">VERSION=&quot;9.1 (Blue Onyx)&quot;</span><br><span class="line">ID=&quot;rocky&quot;</span><br><span class="line">ID_LIKE=&quot;rhel centos fedora&quot;</span><br><span class="line">VERSION_ID=&quot;9.1&quot;</span><br><span class="line">PLATFORM_ID=&quot;platform:el9&quot;</span><br><span class="line">PRETTY_NAME=&quot;Rocky Linux 9.1 (Blue Onyx)&quot;</span><br><span class="line">ANSI_COLOR=&quot;0;32&quot;</span><br><span class="line">LOGO=&quot;fedora-logo-icon&quot;</span><br><span class="line">777CPE_NAME=&quot;cpe:/o:rocky:rocky:9::baseos&quot;</span><br><span class="line">HOME_URL=&quot;https://rockylinux.org/&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;https://bugs.rockylinux.org/&quot;</span><br><span class="line">ROCKY_SUPPORT_PRODUCT=&quot;Rocky-Linux-9&quot;</span><br><span class="line">ROCKY_SUPPORT_PRODUCT_VERSION=&quot;9.1&quot;</span><br><span class="line">REDHAT_SUPPORT_PRODUCT=&quot;Rocky Linux&quot;</span><br><span class="line">REDHAT_SUPPORT_PRODUCT_VERSION=&quot;9.1&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>安装</p>
</blockquote>
<h4 id="1、-卸载Docker的旧版本"><a href="#1、-卸载Docker的旧版本" class="headerlink" title="1、 卸载Docker的旧版本"></a>1、 卸载Docker的旧版本</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure>
<h4 id="2、-安装基本环境"><a href="#2、-安装基本环境" class="headerlink" title="2、 安装基本环境"></a>2、 安装基本环境</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install -y yum-utils</span><br></pre></td></tr></table></figure>
<h4 id="3、设置镜像的仓库"><a href="#3、设置镜像的仓库" class="headerlink" title="3、设置镜像的仓库"></a>3、设置镜像的仓库</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>
<h4 id="4、更新yum源并安装docker-ce"><a href="#4、更新yum源并安装docker-ce" class="headerlink" title="4、更新yum源并安装docker-ce"></a>4、更新yum源并安装docker-ce</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum update --allowerasing --nobest</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin -y</span><br></pre></td></tr></table></figure>
<h4 id="5、启动docker"><a href="#5、启动docker" class="headerlink" title="5、启动docker"></a>5、启动docker</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# systemctl start docker</span><br></pre></td></tr></table></figure>
<h4 id="6、-查看docker-version-查看是否安装成功"><a href="#6、-查看docker-version-查看是否安装成功" class="headerlink" title="6、 查看docker version 查看是否安装成功"></a>6、 查看docker version 查看是否安装成功</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker version</span><br><span class="line">Client: Docker Engine - Community</span><br><span class="line"> Version:           24.0.7</span><br><span class="line"> API version:       1.43</span><br><span class="line"> Go version:        go1.20.10</span><br><span class="line"> Git co-            Thu Oct 26 09:09:13 2023</span><br><span class="line"> OS/Arch:           linux/amd64</span><br><span class="line"> Context:           default</span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          24.0.7</span><br><span class="line">  API version:      1.43 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.20.10</span><br><span class="line">  Git commit:       311b9ff</span><br><span class="line">  Built:            Thu Oct 26 09:07:45 2023</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     false</span><br><span class="line"> containerd:</span><br><span class="line">  Version:          1.6.25</span><br><span class="line">  GitCommit:        d8f198a4ed8892c764191ef7b3b06d8a2eeb5c7f</span><br><span class="line"> runc:</span><br><span class="line">  Version:          1.1.10</span><br><span class="line">  GitCommit:        v1.1.10-0-g18a0cb0</span><br><span class="line"> docker-init:</span><br><span class="line">  Version:          0.19.0</span><br><span class="line">  GitCommit:        de40ad0</span><br></pre></td></tr></table></figure>
<h4 id="7、-运行hello-world"><a href="#7、-运行hello-world" class="headerlink" title="7、 运行hello world"></a>7、 运行hello world</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]<span class="comment"># docker run hello-world</span></span><br><span class="line">Unable to find image <span class="string">&#x27;hello-world:latest&#x27;</span> locally</span><br><span class="line">latest: Pulling from library/hello-world</span><br><span class="line">719385e32844: Pull complete </span><br><span class="line">Digest: sha256:c79d06dfdfd3d3eb04cafd0dc2bacab0992ebc243e083cabe208bac4dd7759e0</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> hello-world:latest</span><br><span class="line"></span><br><span class="line">Hello from Docker!   //看到这句话表明安装成功</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took the following steps:</span><br><span class="line"> 1. The Docker client contacted the Docker daemon.</span><br><span class="line"> 2. The Docker daemon pulled the <span class="string">&quot;hello-world&quot;</span> image from the Docker Hub.</span><br><span class="line">    (amd64)</span><br><span class="line"> 3. The Docker daemon created a new container from that image <span class="built_in">which</span> runs the</span><br><span class="line">    executable that produces the output you are currently reading.</span><br><span class="line"> 4. The Docker daemon streamed that output to the Docker client, <span class="built_in">which</span> sent it</span><br><span class="line">    to your terminal.</span><br><span class="line"></span><br><span class="line">To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line"> $ docker run -it ubuntu bash</span><br><span class="line"></span><br><span class="line">Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line"> https://hub.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples and ideas, visit:</span><br><span class="line"> https://docs.docker.com/get-started/</span><br></pre></td></tr></table></figure>
<h4 id="8、-查看hello-world镜像"><a href="#8、-查看hello-world镜像" class="headerlink" title="8、 查看hello-world镜像"></a>8、 查看hello-world镜像</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    9c7a54a9a43c   7 months ago   13.3kB</span><br></pre></td></tr></table></figure>
<h4 id="了解：卸载docker"><a href="#了解：卸载docker" class="headerlink" title="了解：卸载docker"></a>了解：卸载docker</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 1、卸载依赖</span><br><span class="line">yum remove install docker-ce docker-ce-cli containerd.io docker-compose-plugin -y</span><br><span class="line"></span><br><span class="line"># 2、 删除资源</span><br><span class="line">rm -rf /var/lib/docker</span><br><span class="line"></span><br><span class="line"># /var/lib/docker docker的默认工作路径</span><br></pre></td></tr></table></figure>
<h3 id="配置阿里云加速"><a href="#配置阿里云加速" class="headerlink" title="配置阿里云加速"></a>配置阿里云加速</h3><p>1、 执行命令、查看是否在dockrr.service文件中配置过镜像地址</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl cat docker | grep &#x27;\-\-registry\-mirror&#x27;</span><br></pre></td></tr></table></figure>
<p>2、 在/etc/docker/daemon.json中写入如下内容 （如果文件不存在请新建该文件）</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [</span><br><span class="line">    &quot;https://hub-mirror.c.163.com&quot;,</span><br><span class="line">    &quot;https://mirror.baidubce.com&quot;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一定要确保文件符合jssn规范，否则Docker将不能启动</p>
<p>3、重启docker服务</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>
<h3 id="回顾HelloWorld流程"><a href="#回顾HelloWorld流程" class="headerlink" title="回顾HelloWorld流程"></a>回顾HelloWorld流程</h3><blockquote>
<p>run的运行流程图</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206100712580.png" alt="image-20231206100712580"></p>
<h3 id="底层原理"><a href="#底层原理" class="headerlink" title="底层原理"></a>底层原理</h3><p>Docker是什么工作的？</p>
<p>Docker是一个Client-Server结构的系统，Docker的守护进程运行在主机上。通过Socket从客户端访问！</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206101604313.png" alt="image-20231206101604313"></p>
<p>Docker为什么比VM快？</p>
<ul>
<li>Docker有着比虚拟机更少的抽象层</li>
<li>Docker利用的是宿主机的内核，VM需要是Guest OS。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206101735199.png" alt="image-20231206101735199"></p>
<p>所以说，新建一个容器的时候，docker不需要像虚拟机一样重新加载一个操作系统内核，避免引导。虚拟机时加载Guest OS，分钟级别的，而Docker时利用宿主机的操作系统。</p>
<h2 id="Docker的常用命令"><a href="#Docker的常用命令" class="headerlink" title="Docker的常用命令"></a>Docker的常用命令</h2><h3 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker version   # 显示docker的版本信息</span><br><span class="line">docker info      # 显示docker的系统信息 包括镜像和容器数量</span><br><span class="line">docker --help    # 显示docker的所有命令</span><br></pre></td></tr></table></figure>
<p>帮助文档地址：<a target="_blank" rel="noopener" href="https://docker-practice.github.io/zh-cn/">https://docker-practice.github.io/zh-cn/</a></p>
<h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><ul>
<li>docker images  查看镜像</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    9c7a54a9a43c   7 months ago   13.3kB</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解释</span></span><br><span class="line">REPOSITORY  镜像的仓库源</span><br><span class="line">TAG      镜像的标签</span><br><span class="line">Image ID  镜像的<span class="built_in">id</span></span><br><span class="line">Create    镜像的创建时间</span><br><span class="line">SIZE    镜像的大小</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可选项</span></span><br><span class="line">Options:</span><br><span class="line">  -a, --all         <span class="comment"># 显示镜像的详细信息    </span></span><br><span class="line">  -q, --quiet      <span class="comment"># 只显示镜像id  </span></span><br></pre></td></tr></table></figure>
<ul>
<li>docker search 搜索镜像</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]<span class="comment"># docker search nginx</span></span><br><span class="line">NAME                               DESCRIPTION                                      STARS     OFFICIAL   AUTOMATED</span><br><span class="line">nginx                              Official build of Nginx.                         19320     [OK]       </span><br><span class="line">unit                               Official build of NGINX Unit: Universal Web …    19        [OK]       </span><br><span class="line">nginxinc/nginx-unprivileged        Unprivileged NGINX Dockerfiles                   136     </span><br><span class="line"></span><br><span class="line"><span class="comment"># 可选项，通过搜藏来过来吧</span></span><br><span class="line">--filter=STARS=3000   <span class="comment">## 搜索出的镜像收藏大于3000的</span></span><br></pre></td></tr></table></figure>
<ul>
<li>docker pull 下载镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载镜像 docker pull 镜像名[:tag]</span></span><br><span class="line">[root@k8s ~]# docker pull nginx</span><br><span class="line">Using default tag: latest   # 如果不写tag，默认就是latest</span><br><span class="line">latest: Pulling from library/nginx</span><br><span class="line">1f7ce2fa46ab: Pull complete # 分层下载 docker images的核心 联合文件系统 </span><br><span class="line">9b16c94bb686: Pull complete </span><br><span class="line">9a59d19f9c5b: Pull complete </span><br><span class="line">9ea27b074f71: Pull complete </span><br><span class="line">c6edf33e2524: Pull complete </span><br><span class="line">84b1ff10387b: Pull complete </span><br><span class="line">517357831967: Pull complete </span><br><span class="line">Digest: sha256:10d1f5b58f74683ad34eb29287e07dab1e90f10af243f151bb50aa5dbb4d62ee  # 签名</span><br><span class="line">Status: Downloaded newer image for nginx:latest</span><br><span class="line">docker.io/library/nginx:latest   # 真实地址</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">等价于它</span></span><br><span class="line">docker pull nginx</span><br><span class="line">docker pull docker.io/library/nginx:latest  </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">指定版本下载</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>docker rm 删除镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker rmi -f nginx:latest </span><br><span class="line">Untagged: nginx:latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除所有镜像</span></span><br><span class="line">[root@k8s ~]# docker rmi -f $(docker images -qa)</span><br><span class="line">Untagged: hello-world:latest</span><br><span class="line">Untagged: hello-world@sha256:c79d06dfdfd3d3eb04cafd0dc2bacab0992ebc243e083cabe208bac4dd7759e0</span><br><span class="line">Deleted: sha256:9c7a54a9a43cca047013b82af109fe963fde787f63f9e016fdc3384500c2823d</span><br><span class="line"></span><br><span class="line">[root@k8s ~]# docker images</span><br><span class="line">REPOSITORY   TAG       IMAGE ID   CREATED   SIZE</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><p>说明： 我们有了镜像才可以创建容器、linux、下载一个centos来测试学习</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure>
<p><strong>新建容器并启动</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run [可选参数] image</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">参数说明</span></span><br><span class="line">--name=&quot;Name&quot;   容器名字 tomcat1 tomxat2 tomcat3 用来区分容器</span><br><span class="line">-d         后台方式运行</span><br><span class="line">-it        使用交互方式运行，进入容器 查看内容</span><br><span class="line">-p         指定容器端口   -p 8080:80</span><br><span class="line">-P        随机指定端口</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动并进入容器</span></span><br><span class="line">[root@k8s ~]# docker run -it centos /bin/bash</span><br><span class="line">[root@83711eb4d20a /]# </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看容器内的centos</span></span><br><span class="line">[root@83711eb4d20a /]# ls</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">退回主机</span></span><br><span class="line">[root@83711eb4d20a /]# exit</span><br><span class="line">exit</span><br><span class="line">[root@k8s ~]# </span><br></pre></td></tr></table></figure>
<p><strong>列出运行中的容器</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker ps 命令</span></span><br><span class="line">-a    # 列出当前正在运行的容器+带出历史运行过的容器</span><br><span class="line">-n=?  #显示最近创建的容器</span><br><span class="line">-q    # 只显示容器的编号</span><br><span class="line">[root@k8s ~]# docker ps -a -n=1</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND       CREATED         STATUS                     PORTS     NAMES</span><br><span class="line">83711eb4d20a   centos    &quot;/bin/bash&quot;   4 minutes ago   Exited (0) 2 minutes ago             awesome_lederberg</span><br><span class="line"></span><br><span class="line">[root@k8s ~]# docker ps -aq</span><br><span class="line">83711eb4d20a</span><br><span class="line">e36750cdcde1</span><br></pre></td></tr></table></figure>
<ul>
<li>退出容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">exit  # 停止容器并退出</span><br><span class="line">ctrl Q P  # 退出并不停止</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行容器并执行退出并不停止指令</span></span><br><span class="line">[root@k8s ~]# docker run -it centos /bin/bash</span><br><span class="line">[root@69296df22e03 /]# [root@k8s ~]# </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看当前运行的容器</span></span><br><span class="line">[root@k8s ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND       CREATED          STATUS          PORTS     NAMES</span><br><span class="line">69296df22e03   centos    &quot;/bin/bash&quot;   12 seconds ago   Up 11 seconds             cool_bouman</span><br></pre></td></tr></table></figure>
<ul>
<li>删除容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker rm 容器id   # 删除指定容器，不能删除正在运行的容器 如果要强制删除 rm -f</span><br><span class="line">docker rm -f $(docker ps -aq)    # 删除所有容器</span><br></pre></td></tr></table></figure>
<ul>
<li>启动和停止容器的操作</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker start 容器id    # 启动容器</span><br><span class="line">docker restart 容器id  # 重启容器</span><br><span class="line">docker stop 容器id     # 停止当前正在运行的容器</span><br><span class="line">docker kill 容器id     # 强制停止当前容器</span><br></pre></td></tr></table></figure>
<h3 id="常用其它命令"><a href="#常用其它命令" class="headerlink" title="常用其它命令"></a>常用其它命令</h3><p><strong>后台启动容器</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker run -d centos    //后台启动容器</span><br><span class="line">c75899a445cd92b117337f1bb80c4606dcef87f0dbdda1c76149301b5dcb4725</span><br><span class="line"></span><br><span class="line">[root@k8s ~]# docker ps -a   //查看容器</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND       CREATED         STATUS                     PORTS     NAMES</span><br><span class="line">c75899a445cd   centos    &quot;/bin/bash&quot;   2 minutes ago   Exited (0) 2 minutes ago             elegant_edison           cool_bouman</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">问题 docker ps，发现centos 停止了</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">常见的坑 docker容器使用后台运行  就必须有一个前台进程，docker发现没有应用，就会自动停止</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nginx，容器启动后，发现自己没有提供服务 就会立刻停止</span></span><br></pre></td></tr></table></figure>
<p><strong>利用死循环让容器有事可做</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建容器 并在其中编写一个shell脚本</span></span><br><span class="line">[root@k8s ~]# docker run -d centos /bin/sh -c &quot;while true;do echo kuangshen;sleep 1;done&quot;</span><br><span class="line">bf139241a91b97b33d8fbefdec9b7c337500dafc5d270e40407b516f7b66ab0c</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看容器状态</span></span><br><span class="line">[root@k8s ~]# docker ps </span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                   CREATED          STATUS          PORTS     NAMES</span><br><span class="line">bf139241a91b   centos    &quot;/bin/sh -c &#x27;while t…&quot;   17 seconds ago   Up 16 seconds             modest_kilby</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看容器日志</span></span><br><span class="line">[root@k8s ~]# docker logs -t -f --tail 10 bf139241a91b</span><br><span class="line">2023-12-06T03:40:39.057567655Z kuangshen</span><br><span class="line">2023-12-06T03:40:40.059862129Z kuangshen</span><br><span class="line">2023-12-06T03:40:41.062034487Z kuangshen</span><br><span class="line">2023-12-06T03:40:42.064470085Z kuangshen</span><br><span class="line">2023-12-06T03:40:43.066782894Z kuangshen</span><br></pre></td></tr></table></figure>
<p><strong>查看日志</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker logs -f -t --tail 容器，没有日志</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">自己编写一段shell脚本</span></span><br><span class="line">&quot;whlie ture;do echo toto;sleep 2;done&quot;                  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示日志</span></span><br><span class="line">-tf  # 显示日志</span><br><span class="line">--tail  number  # 要显示的日志条数</span><br><span class="line">[root@k8s ~]# docker logs -f -t --tail 10 7a173bcad9ba  查看容器日志</span><br><span class="line">2023-12-06T03:31:50.560503837Z /bin/sh: whlie ture;do echo toto;sleep 2;done: No such file or directory</span><br></pre></td></tr></table></figure>
<p><strong>查看容器中的进程信息 ps</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker top bf139241a91b</span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">root                10569               10532               0                   22:38               ?                   00:00:00            /bin/sh -c while true;do echo kuangshen;sleep 1;done</span><br><span class="line">root                11713               10569               0                   22:48               ?                   00:00:00            /usr/bin/coreutils --coreutils-prog-shebang=sleep /usr/bin/sleep 1</span><br></pre></td></tr></table></figure>
<p><strong>查看镜像源数据</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker inspect bf139241a91b</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;bf139241a91b97b33d8fbefdec9b7c337500dafc5d270e40407b516f7b66ab0c&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2023-12-06T03:38:56.618698931Z&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/bin/sh&quot;,</span><br><span class="line">        &quot;Args&quot;: [</span><br><span class="line">            &quot;-c&quot;,</span><br><span class="line">            &quot;while true;do echo kuangshen;sleep 1;done&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;State&quot;: &#123;</span><br><span class="line">            &quot;Status&quot;: &quot;running&quot;,</span><br><span class="line">            &quot;Running&quot;: true,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 10569,</span><br><span class="line">            &quot;ExitCode&quot;: 0,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2023-12-06T03:38:56.841697401Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:5d0da3dc976460b72c77d94c8a1ad043720b0416bfc16c52c45d4847e53fadb6&quot;,</span><br><span class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/bf139241a91b97b33d8fbefdec9b7c337500dafc5d270e40407b516f7b66ab0c/resolv.conf&quot;,</span><br><span class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/bf139241a91b97b33d8fbefdec9b7c337500dafc5d270e40407b516f7b66ab0c/hostname&quot;,</span><br><span class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/bf139241a91b97b33d8fbefdec9b7c337500dafc5d270e40407b516f7b66ab0c/hosts&quot;,</span><br><span class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/bf139241a91b97b33d8fbefdec9b7c337500dafc5d270e40407b516f7b66ab0c/bf139241a91b97b33d8fbefdec9b7c337500dafc5d270e40407b516f7b66ab0c-json.log&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;/modest_kilby&quot;,</span><br><span class="line">        &quot;RestartCount&quot;: 0,</span><br><span class="line">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br><span class="line">        &quot;Platform&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;MountLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;AppArmorProfile&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ExecIDs&quot;: null,</span><br><span class="line">        &quot;HostConfig&quot;: &#123;</span><br><span class="line">            &quot;Binds&quot;: null,</span><br><span class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LogConfig&quot;: &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;json-file&quot;,</span><br><span class="line">                &quot;Config&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;NetworkMode&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;PortBindings&quot;: &#123;&#125;,</span><br><span class="line">            &quot;RestartPolicy&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;no&quot;,</span><br><span class="line">                &quot;MaximumRetryCount&quot;: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;AutoRemove&quot;: false,</span><br><span class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br><span class="line">            &quot;VolumesFrom&quot;: null,</span><br><span class="line">            &quot;ConsoleSize&quot;: [</span><br><span class="line">                46,</span><br><span class="line">                153</span><br><span class="line">            ],</span><br><span class="line">            &quot;CapAdd&quot;: null,</span><br><span class="line">            &quot;CapDrop&quot;: null,</span><br><span class="line">            &quot;CgroupnsMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Dns&quot;: [],</span><br><span class="line">            &quot;DnsOptions&quot;: [],</span><br><span class="line">            &quot;DnsSearch&quot;: [],</span><br><span class="line">            &quot;ExtraHosts&quot;: null,</span><br><span class="line">            &quot;GroupAdd&quot;: null,</span><br><span class="line">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Cgroup&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Links&quot;: null,</span><br><span class="line">            &quot;OomScoreAdj&quot;: 0,</span><br><span class="line">            &quot;PidMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Privileged&quot;: false,</span><br><span class="line">            &quot;PublishAllPorts&quot;: false,</span><br><span class="line">            &quot;ReadonlyRootfs&quot;: false,</span><br><span class="line">            &quot;SecurityOpt&quot;: null,</span><br><span class="line">            &quot;UTSMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;ShmSize&quot;: 67108864,</span><br><span class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br><span class="line">            &quot;Isolation&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpuShares&quot;: 0,</span><br><span class="line">            &quot;Memory&quot;: 0,</span><br><span class="line">            &quot;NanoCpus&quot;: 0,</span><br><span class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br><span class="line">            &quot;BlkioWeight&quot;: 0,</span><br><span class="line">            &quot;BlkioWeightDevice&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadBps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceWriteBps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadIOps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceWriteIOps&quot;: [],</span><br><span class="line">            &quot;CpuPeriod&quot;: 0,</span><br><span class="line">            &quot;CpuQuota&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimePeriod&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br><span class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Devices&quot;: [],</span><br><span class="line">            &quot;DeviceCgroupRules&quot;: null,</span><br><span class="line">            &quot;DeviceRequests&quot;: null,</span><br><span class="line">            &quot;MemoryReservation&quot;: 0,</span><br><span class="line">            &quot;MemorySwap&quot;: 0,</span><br><span class="line">            &quot;MemorySwappiness&quot;: null,</span><br><span class="line">            &quot;OomKillDisable&quot;: null,</span><br><span class="line">            &quot;PidsLimit&quot;: null,</span><br><span class="line">            &quot;Ulimits&quot;: null,</span><br><span class="line">            &quot;CpuCount&quot;: 0,</span><br><span class="line">            &quot;CpuPercent&quot;: 0,</span><br><span class="line">            &quot;IOMaximumIOps&quot;: 0,</span><br><span class="line">            &quot;IOMaximumBandwidth&quot;: 0,</span><br><span class="line">            &quot;MaskedPaths&quot;: [</span><br><span class="line">                &quot;/proc/asound&quot;,</span><br><span class="line">                &quot;/proc/acpi&quot;,</span><br><span class="line">                &quot;/proc/kcore&quot;,</span><br><span class="line">                &quot;/proc/keys&quot;,</span><br><span class="line">                &quot;/proc/latency_stats&quot;,</span><br><span class="line">                &quot;/proc/timer_list&quot;,</span><br><span class="line">                &quot;/proc/timer_stats&quot;,</span><br><span class="line">                &quot;/proc/sched_debug&quot;,</span><br><span class="line">                &quot;/proc/scsi&quot;,</span><br><span class="line">                &quot;/sys/firmware&quot;,</span><br><span class="line">                &quot;/sys/devices/virtual/powercap&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReadonlyPaths&quot;: [</span><br><span class="line">                &quot;/proc/bus&quot;,</span><br><span class="line">                &quot;/proc/fs&quot;,</span><br><span class="line">                &quot;/proc/irq&quot;,</span><br><span class="line">                &quot;/proc/sys&quot;,</span><br><span class="line">                &quot;/proc/sysrq-trigger&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/1f2d513a668a223e0ca04353b567a1fd88c1ff384472805d82e7aca0ab1aa7e0-init/diff:/var/lib/docker/overlay2/3d9e04ce7377c934935b44d560ac38c7fabad822afe5277a0aebcc4dc18a7f1f/diff&quot;,</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/1f2d513a668a223e0ca04353b567a1fd88c1ff384472805d82e7aca0ab1aa7e0/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/1f2d513a668a223e0ca04353b567a1fd88c1ff384472805d82e7aca0ab1aa7e0/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/1f2d513a668a223e0ca04353b567a1fd88c1ff384472805d82e7aca0ab1aa7e0/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [],</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;bf139241a91b&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: false,</span><br><span class="line">            &quot;AttachStdout&quot;: false,</span><br><span class="line">            &quot;AttachStderr&quot;: false,</span><br><span class="line">            &quot;Tty&quot;: false,</span><br><span class="line">            &quot;OpenStdin&quot;: false,</span><br><span class="line">            &quot;StdinOnce&quot;: false,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/bin/sh&quot;,</span><br><span class="line">                &quot;-c&quot;,</span><br><span class="line">                &quot;while true;do echo kuangshen;sleep 1;done&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;centos&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;</span><br><span class="line">                &quot;org.label-schema.build-date&quot;: &quot;20210915&quot;,</span><br><span class="line">                &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;,</span><br><span class="line">                &quot;org.label-schema.name&quot;: &quot;CentOS Base Image&quot;,</span><br><span class="line">                &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;,</span><br><span class="line">                &quot;org.label-schema.vendor&quot;: &quot;CentOS&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">            &quot;Bridge&quot;: &quot;&quot;,</span><br><span class="line">            &quot;SandboxID&quot;: &quot;aed70a42c2b8aeace833daa6eb8eb1957d96b3f6d9e8ae08be93ca8ce982429c&quot;,</span><br><span class="line">            &quot;HairpinMode&quot;: false,</span><br><span class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;Ports&quot;: &#123;&#125;,</span><br><span class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/aed70a42c2b8&quot;,</span><br><span class="line">            &quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br><span class="line">            &quot;EndpointID&quot;: &quot;01577e66ee97687e028f2e0760a5c62369a33ad1cfce03cac440f8464df67387&quot;,</span><br><span class="line">            &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPAddress&quot;: &quot;172.17.0.4&quot;,</span><br><span class="line">            &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;MacAddress&quot;: &quot;02:42:ac:11:00:04&quot;,</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;26c6fbe3fe76e6e36a1833f32b0d5216a17c1fd70f9a6efd037114bba1cd56c8&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;01577e66ee97687e028f2e0760a5c62369a33ad1cfce03cac440f8464df67387&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.17.0.4&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:04&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><strong>进入当前正在运行的容器</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们通常容器都是使用后台方式运行的，需要进入容器，修改一些配置</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令</span></span><br><span class="line">docker exec -it 容器id bashshell</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用<span class="built_in">exec</span>进入容器</span></span><br><span class="line">[root@k8s ~]# docker exec -it bf139241a91b bash</span><br><span class="line">[root@bf139241a91b /]# ps -ef</span><br><span class="line">UID          PID    PPID  C STIME TTY          TIME CMD</span><br><span class="line">root           1       0  0 03:38 ?        00:00:00 /bin/sh -c while true;do echo kuangshen;sleep 1;done</span><br><span class="line">root        1275       0  0 04:00 pts/0    00:00:00 bash</span><br><span class="line">root        1309       1  0 04:00 ?        00:00:00 /usr/bin/coreutils --coreutils-prog-shebang=sleep /usr/bin/sleep 1</span><br><span class="line">root        1310    1275  0 04:00 pts/0    00:00:00 ps -ef</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">方式二</span></span><br><span class="line"></span><br><span class="line">docker attach 容器id</span><br><span class="line"></span><br><span class="line">[root@k8s ~]# docker attach   bf139241a91b</span><br><span class="line">kuangshen</span><br><span class="line">kuangshen</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker <span class="built_in">exec</span>   <span class="comment"># 进入容器后开启一个新的终端</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker attch  <span class="comment"># 进入容器正在执行的终端，不会启动新的进程</span></span></span><br></pre></td></tr></table></figure>
<p><strong>从容器内拷贝文件到容器外</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker cp 容器id：容器内路径   目的的主机路径</span><br><span class="line"></span><br><span class="line">[root@k8s home]# docker cp b25a87d930f8:/home/test.java /home</span><br><span class="line">Successfully copied 1.54kB to /home</span><br><span class="line">[root@k8s home]# ls</span><br><span class="line">ayaka  kuangshen.java  test.java  toto</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>exec会进入容器并开启一个新bash终端,exit时不会导致容器stop，attach退出时会导致容器stop</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">attach    Attach to a running container  <span class="comment">#当前shell下attach连接指定运行镜像</span></span><br><span class="line">build     Build an image from a Dockerfile  <span class="comment">#通过Dockerfile定制镜像</span></span><br><span class="line">commit    Create a new image from a container<span class="string">&#x27;s changes  #提交当前容器为新的镜像</span></span><br><span class="line"><span class="string">cp    Copy files/folders from a container to a HOSTDIR or to STDOUT  #从容器中拷贝指定文件或者目录到宿主机中</span></span><br><span class="line"><span class="string">create    Create a new container  #创建一个新的容器，同run 但不启动容器</span></span><br><span class="line"><span class="string">diff    Inspect changes on a container&#x27;</span>s filesystem  <span class="comment">#查看docker容器变化</span></span><br><span class="line">events    Get real time events from the server<span class="comment">#从docker服务获取容器实时事件</span></span><br><span class="line"><span class="built_in">exec</span>    Run a <span class="built_in">command</span> <span class="keyword">in</span> a running container<span class="comment">#在已存在的容器上运行命令</span></span><br><span class="line"><span class="built_in">export</span>    Export a container<span class="string">&#x27;s filesystem as a tar archive  #导出容器的内容流作为一个tar归档文件(对应import)</span></span><br><span class="line"><span class="string">history    Show the history of an image  #展示一个镜像形成历史</span></span><br><span class="line"><span class="string">rename    Rename a container  #重命名容器</span></span><br><span class="line"><span class="string">restart    Restart a running container  #重启运行的容器</span></span><br><span class="line"><span class="string">rm    Remove one or more containers  #移除一个或者多个容器</span></span><br><span class="line"><span class="string">rmi    Remove one or more images  #移除一个或多个镜像(无容器使用该镜像才可以删除，否则需要删除相关容器才可以继续或者-f强制删除)</span></span><br><span class="line"><span class="string">run    Run a command in a new container  #创建一个新的容器并运行一个命令</span></span><br><span class="line"><span class="string">save    Save an image(s) to a tar archive#保存一个镜像为一个tar包(对应load)</span></span><br><span class="line"><span class="string">search    Search the Docker Hub for images  #在dockerhub中搜索镜像</span></span><br><span class="line"><span class="string">start    Start one or more stopped containers#启动容器</span></span><br><span class="line"><span class="string">stats    Display a live stream of container(s) resource usage statistics  #统计容器使用资源</span></span><br><span class="line"><span class="string">stop    Stop a running container  #停止容器</span></span><br><span class="line"><span class="string">tag         Tag an image into a repository  #给源中镜像打标签</span></span><br><span class="line"><span class="string">top       Display the running processes of a container #查看容器中运行的进程信息</span></span><br><span class="line"><span class="string">unpause    Unpause all processes within a container  #取消暂停容器</span></span><br><span class="line"><span class="string">version    Show the Docker version information#查看容器版本号</span></span><br><span class="line"><span class="string">wait         Block until a container stops, then print its exit code  #截取容器停止时的退出状态值</span></span><br><span class="line"><span class="string">images    List images  #列出系统当前镜像</span></span><br><span class="line"><span class="string">import    Import the contents from a tarball to create a filesystem image  #从tar包中的内容创建一个新的文件系统映像(对应export)</span></span><br><span class="line"><span class="string">info    Display system-wide information  #显示系统相关信息</span></span><br><span class="line"><span class="string">inspect    Return low-level information on a container or image  #查看容器详细信息</span></span><br><span class="line"><span class="string">kill    Kill a running container  #kill指定docker容器</span></span><br><span class="line"><span class="string">load    Load an image from a tar archive or STDIN  #从一个tar包中加载一个镜像(对应save)</span></span><br><span class="line"><span class="string">login    Register or log in to a Docker registry#注册或者登陆一个docker源服务器</span></span><br><span class="line"><span class="string">logout    Log out from a Docker registry  #从当前Docker registry退出</span></span><br><span class="line"><span class="string">logs    Fetch the logs of a container  #输出当前容器日志信息</span></span><br><span class="line"><span class="string">pause    Pause all processes within a container#暂停容器</span></span><br><span class="line"><span class="string">port    List port mappings or a specific mapping for the CONTAINER  #查看映射端口对应的容器内部源端口</span></span><br><span class="line"><span class="string">ps    List containers  #列出容器列表</span></span><br><span class="line"><span class="string">pull    Pull an image or a repository from a registry  #从docker镜像源服务器拉取指定镜像或者库镜像</span></span><br><span class="line"><span class="string">push    Push an image or a repository to a registry  #推送指定镜像或者库镜像至docker源服务器</span></span><br></pre></td></tr></table></figure>
<h2 id="Docker安装Nginx"><a href="#Docker安装Nginx" class="headerlink" title="Docker安装Nginx"></a>Docker安装Nginx</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">搜索镜像 下载镜像</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载镜像 pull</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行模式</span></span><br><span class="line"></span><br><span class="line">1、下载nginx镜像 </span><br><span class="line">docker pull nginx</span><br><span class="line"></span><br><span class="line">2、查看镜像</span><br><span class="line">[root@k8s ~]# docker images </span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">nginx         latest    a6bd71f48f68   2 weeks ago    187MB</span><br><span class="line">hello-world   latest    9c7a54a9a43c   7 months ago   13.3kB</span><br><span class="line">centos        latest    5d0da3dc9764   2 years ago    231MB</span><br><span class="line"></span><br><span class="line">3、创建容器</span><br><span class="line">docker run -d --name web1 -p 8001:80 nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-d  后台运行容器</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--name  给容器命名</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-p   宿主机端口：容器内部端口</span></span><br><span class="line">4、查看容器列表</span><br><span class="line">[root@k8s ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                   CREATED         STATUS         PORTS                                   NAMES</span><br><span class="line">354382b1bdb4   nginx     &quot;/docker-entrypoint.…&quot;   2 minutes ago   Up 2 minutes   0.0.0.0:8001-&gt;80/tcp, :::8001-&gt;80/tcp   web1</span><br><span class="line">5、访问本机的8001端口</span><br><span class="line">[root@k8s ~]# curl 192.168.123.101:8001</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">html &#123; color-scheme: light dark; &#125;</span><br><span class="line">body &#123; width: 35em; margin: 0 auto;</span><br><span class="line">font-family: Tahoma, Verdana, Arial, sans-serif; &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br><span class="line">working. Further configuration is required.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;For online documentation and support please refer to</span><br><span class="line">&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br><span class="line">Commercial support is available at</span><br><span class="line">&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>思考问题：我们每次改动nginx配置文件，都需要进入容器内部？十分的麻烦，我要是可以再容器外部提供一个映射的路径，在容器修改文件，容器内部就可以自动修改？</p>
<p>-v 数据卷</p>
<h2 id="docker安装tomcat"><a href="#docker安装tomcat" class="headerlink" title="docker安装tomcat"></a>docker安装tomcat</h2><h3 id="一、下载tomcat"><a href="#一、下载tomcat" class="headerlink" title="一、下载tomcat"></a>一、下载tomcat</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull tomcat</span><br></pre></td></tr></table></figure>
<h3 id="二、检查镜像"><a href="#二、检查镜像" class="headerlink" title="二、检查镜像"></a>二、检查镜像</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">tomcat        latest    e76527586e57   3 days ago     454MB</span><br></pre></td></tr></table></figure>
<h3 id="三、启动运行tomcat"><a href="#三、启动运行tomcat" class="headerlink" title="三、启动运行tomcat"></a>三、启动运行tomcat</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker run -d -p 8002:8080 --name tomcat01 tomcat</span><br><span class="line">ce4f651b97a28c829ca4a055fdc44fb389d21ffa8520bb2060c05031771a0403</span><br></pre></td></tr></table></figure>
<h3 id="四、测试访问tomcat"><a href="#四、测试访问tomcat" class="headerlink" title="四、测试访问tomcat"></a>四、测试访问tomcat</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# curl localhost:8002</span><br><span class="line">&lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 404 – Not Found&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body &#123;font-family:Tahoma,Arial,sans-serif;&#125; h1, h2, h3, b &#123;color:white;background-color:#525D76;&#125; h1 &#123;font-size:22px;&#125; h2 &#123;font-size:16px;&#125; h3 &#123;font-size:14px;&#125; p &#123;font-size:12px;&#125; a &#123;color:black;&#125; .line &#123;height:1px;background-color:#525D76;border:none;&#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 404 – Not Found&lt;/h1&gt;&lt;hr class=&quot;line&quot; /&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt; Status Report&lt;/p&gt;&lt;p&gt;&lt;b&gt;Description&lt;/b&gt; The origin server did not find a current representation for the target resource or is not willing to disclose that one exists.&lt;/p&gt;&lt;hr class=&quot;line&quot; /&gt;&lt;h3&gt;Apache Tomcat/10.1.16&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;[</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206145030002.png" alt="image-20231206145030002"></p>
<p><strong>发生404报错  说明缺少配置</strong></p>
<h3 id="五、进入tomcat容器"><a href="#五、进入tomcat容器" class="headerlink" title="五、进入tomcat容器"></a>五、进入tomcat容器</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker exec -it tomcat01 bash</span><br><span class="line"></span><br><span class="line">root@ce4f651b97a2:/usr/local/tomcat# cd webapps</span><br><span class="line">root@ce4f651b97a2:/usr/local/tomcat/webapps# ls</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">发现问题 Linux命令少了 没有webapps。</span></span><br><span class="line">原因：</span><br><span class="line">tomcat默认是最小的镜像 把所有没必要的配置文件都删除</span><br><span class="line">保证最小可运行的环境</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进入webapps.dist</span></span><br><span class="line">root@ce4f651b97a2:/usr/local/tomcat/webapps/webapps.dist# ls</span><br><span class="line">docs  examples  host-manager  manager  ROOT</span><br><span class="line"></span><br><span class="line">发现：</span><br><span class="line">webapps.dist目录下存在的所有目录都是webapps的 我们将该目录的所有配置文件复制到webapps里卖弄</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">复制文件</span></span><br><span class="line">root@ce4f651b97a2:/usr/local/tomcat# cp -a webapps.dist/* webapps/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">保存并退出容器 再次进行访问</span></span><br></pre></td></tr></table></figure>
<p><strong>保存并退出容器 再次进行访问</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206145754654.png" alt="image-20231206145754654"></p>
<p><strong>网页就已经有内容了</strong></p>
<p>思考问题：当每次部署服务时，每次都要进入容器是否十分麻烦？我要是可以在容器外部提供一个映射路径，webapps。我们在外部放置项目，就自动同步到内部就好了！</p>
<h2 id="部署es-kibana"><a href="#部署es-kibana" class="headerlink" title="部署es+kibana"></a>部署es+kibana</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># es 暴露的端口很多</span><br><span class="line"># es 十分的耗内存</span><br><span class="line"># es 的数据一般需要放置到安全目录！挂载</span><br></pre></td></tr></table></figure>
<h3 id="启动elasticsearch"><a href="#启动elasticsearch" class="headerlink" title="启动elasticsearch"></a>启动elasticsearch</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d --name elasticsearch2 -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; --memory=&quot;4g&quot; -e &quot;ES_JAVA_OPTS=-Xms1024m -Xmx2048m&quot; --ulimit nofile=1024   elasticsearch</span><br></pre></td></tr></table></figure>
<h3 id="docker-stats查看cpu状态"><a href="#docker-stats查看cpu状态" class="headerlink" title="docker stats查看cpu状态"></a>docker stats查看cpu状态</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker stats</span><br><span class="line"></span><br><span class="line">CONTAINER ID   NAME             CPU %     MEM USAGE / LIMIT   MEM %     NET I/O         BLOCK I/O         PIDS</span><br><span class="line">f8fac70c779b   elasticsearch2   0.17%     1.226GiB / 4GiB     30.64%    3.18kB / 771B   63.2MB / 2.14MB   66</span><br></pre></td></tr></table></figure>
<p><strong>访问测试9200端口</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# curl localhost:9200</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot; : &quot;yJ3yRFr&quot;,</span><br><span class="line">  &quot;cluster_name&quot; : &quot;elasticsearch&quot;,</span><br><span class="line">  &quot;cluster_uuid&quot; : &quot;kdlRE7FlQHGQji1MK8CNcQ&quot;,</span><br><span class="line">  &quot;version&quot; : &#123;</span><br><span class="line">    &quot;number&quot; : &quot;5.6.12&quot;,</span><br><span class="line">    &quot;build_hash&quot; : &quot;cfe3d9f&quot;,</span><br><span class="line">    &quot;build_date&quot; : &quot;2018-09-10T20:12:43.732Z&quot;,</span><br><span class="line">    &quot;build_snapshot&quot; : false,</span><br><span class="line">    &quot;lucene_version&quot; : &quot;6.6.1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br><span class="line">[root@k8s ~]# </span><br></pre></td></tr></table></figure>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><ul>
<li>portainer</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d -p 8088:9000 \ --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>
<ul>
<li>Rancher （CI/CD再用）</li>
</ul>
<p><strong>什么是portainer</strong></p>
<p>一、 docker的图形化界面管理工具，提供一个后台面板供我们操作</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d -p 8088:9000 \ --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>
<p>二、访问本地主机的8088端口</p>
<ul>
<li>进入后的面板</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/WaitAyaka/wait-ayaka-pictures/raw/master/image-20231206163019399.png" alt="image-20231206163019399"></p>
<p>可视化面板我们平时不会使用，大家测试玩玩即可</p>
<h2 id="Docker镜像讲解"><a href="#Docker镜像讲解" class="headerlink" title="Docker镜像讲解"></a>Docker镜像讲解</h2><h3 id="镜像是什么"><a href="#镜像是什么" class="headerlink" title="镜像是什么"></a>镜像是什么</h3><p>镜像是一种轻量级、可执行的独立软件包、用来打包软件运行环境和基于运行环境开发的软件、包含运行某个软件所需的所有内容、包括代码、运行库、环境变量和配置文件</p>
<p>所用应用打包到docker镜像</p>
<p>如何得到镜像：</p>
<ul>
<li>远程仓库下载</li>
<li>朋友拷给你</li>
<li>自己制作一个镜像dockerfile</li>
</ul>
<h3 id="Docker镜像加载原理"><a href="#Docker镜像加载原理" class="headerlink" title="Docker镜像加载原理"></a>Docker镜像加载原理</h3><blockquote>
<p> UnionFS （联合文件系统）</p>
</blockquote>
<p>UnionFS（联合文件系统）：Union文件系统是一种分层、轻量级并且高性能的文件系统、它支持对文件系统的修改作为一次提交来一层层的叠加、同时可以将不同目录挂载同一个虚拟文件系统下。Union文件系统时Docker镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</p>
<p>特性：一次他哦那个是加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终文件系统会包含所有底层的文件和目录。</p>
<blockquote>
<p>Docker镜像加载原理</p>
</blockquote>
<p>docker镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS</p>
<p>bootfs主要包含bootloader和kernel，bootloader主要是引导加载kernel，Linux刚启动时会加载bootfs文件系统。</p>
<p>在Docker镜像的最底层时bootfs。这一层与我们典型的Linux/Unix系统是一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了。此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。</p>
<p>rootfs（root file system），在bootfs之上。包含的就是典型Linux系统中的/dev,/proc,/bin,/etc等标准目录和文件。rootfs就是各种不同操作系统的发行版，比如Ubuntu，Centos等。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206194149946.png" alt="image-20231206194149946"></p>
<p>   平时我们安装进虚拟机的Centos都是好几个G，为什么Docker这里才200M？</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206195003842.png" alt="image-20231206195003842"></p>
<p>对于一个精简的OS，rootfs可以很小，只需要包含最基本的命令，工具和程序库就可以了，因为底层直接用Host的kernel，自己只需要提供rootfs就可以了。由此可见对于不同的linux发行版，bootfs最基本时一直的，rootfs会有差别，因此不同的发行版可以公用bootfs。</p>
<h3 id="分层理解"><a href="#分层理解" class="headerlink" title="分层理解"></a>分层理解</h3><blockquote>
<p>分层的镜像</p>
</blockquote>
<p>我们可以去下载一个镜像，注意观察下载的日志输出，可以看到时一层一层的在下载！</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206200629998.png" alt="image-20231206200629998"></p>
<p>理解：</p>
<p>所有的Docker镜像都起始于一个基础镜像层，当进行修改或增加新的内容时，就会在当前镜像层上面，创建新的镜像层。</p>
<p>举一个简单的例子，假如基于Ubuntu Linux创建一个新的镜像，这就是新镜像的第一层，如果在该镜像中添加Python包，就会在基础镜像层之上创建第二个镜像层，如果继续添加一个安全补丁，就会创建第三个镜像层。</p>
<p>该镜像当前已经包含3个镜像层，如下图所示：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/WaitAyaka/wait-ayaka-pictures/raw/master/image-20231207082519068.png" alt="image-20231207082519068"></p>
<p>在添加额外的镜像层的同时，镜像始终保持时当前所有镜像的组合，下图中，每个镜像层包含3个文件，而镜像包含了来自两个镜像层的6个文件。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207082641558.png" alt="image-20231207082641558"></p>
<p>上图中的镜像跟之前略有区别，便于展示文件。</p>
<p>下图中展示了一个稍微复杂的三层镜像，在外部看来整个镜像只有6个文件，这是因为最上层中的文件7时文件5的一个更新的版本。<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/WaitAyaka/wait-ayaka-pictures/raw/master/image-20231207082752378.png" alt="image-20231207082752378"></p>
<p>这种情况下，上层镜像层中的文件覆盖了顶层镜像层中的文件，这样使得文件的更新版本作为一个新镜像层添加到镜像当中。</p>
<p>Docker通过存储引擎（新版本采用快照机制）的方式来实现镜像层的堆栈，并保证多镜像层对外展示统一的文件系统。</p>
<p>Linux上可用的村塾引擎由AUFS，Overlay2.故名思意，每种存储引擎都基于Linux中对应的文件一同或者块这杯技术。</p>
<p>Docker在Windows上仅支持windowsfilter一种存储引擎，该殷勤基于NTFS文件系统之上实现了分层</p>
<blockquote>
<p>特点</p>
</blockquote>
<p>Docker镜像都是只读的，当容器启动时，一个新的可写层被加载到镜像的顶部。</p>
<p>这一层就是我们常说的容器层，容器之下的都叫镜像层。</p>
<p>特点</p>
<p>Docker镜像都是只读的，当容器启动时 （run），一个新的可写层被加载到镜像的顶部！</p>
<p>这一层就是我们所说的容器层，容器之下的都叫镜像层（pull）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206201714143.png" alt="image-20231206201714143"></p>
<p>如何提交一个自己的镜像</p>
<h3 id="commit镜像"><a href="#commit镜像" class="headerlink" title="commit镜像"></a>commit镜像</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker commit 提交容器成为一个新的副本</span><br><span class="line"></span><br><span class="line"># 命令和git原理类似</span><br><span class="line">docker  commit -m=“提交的描述信息” -a=“作者” 容器id  目标镜像名，[Tag]</span><br></pre></td></tr></table></figure>
<p>实战测试</p>
<p>一、启动一个默认的tomcat</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">发现这个默认的tomcat 是没有webapps应用的 镜像的原因 官方的镜像默认webapps下面是没有文件的！</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我自己拷贝进去了的基本的文件</span></span><br><span class="line">root@814727eb2952:/usr/local/tomcat# cp -r webapps.dist/* webapps</span><br><span class="line">root@814727eb2952:/usr/local/tomcat# ls webapps</span><br><span class="line">docs  examples  host-manager  manager  ROOT</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看容器列表</span></span><br><span class="line">[root@k8s ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE                 COMMAND             CREATED         STATUS          PORTS                                                           NAMES</span><br><span class="line">814727eb2952   tomcat                &quot;catalina.sh run&quot;   4 minutes ago   Up 4 minutes    0.0.0.0:8080-&gt;8080/tcp, :::8080-&gt;8080/tcp                       lucid_meninsky</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">commit修改好的tomcat容器为tomcat02:1.0镜像</span></span><br><span class="line">[root@k8s ~]# docker commit -a=&quot;ayaka&quot; -m=&quot;add webapps app&quot; 814727eb2952 tomcat02:1.0</span><br><span class="line">sha256:60e11d6e91c0a5a5bd66de73240e84f644b453be6e97b378f0aba5f63d0aaa9e</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看镜像库</span></span><br><span class="line">[root@k8s ~]# docker images</span><br><span class="line">REPOSITORY            TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">tomcat02              1.0       60e11d6e91c0   4 seconds ago   458MB</span><br><span class="line">tomcat                latest    e76527586e57   4 days ago      454MB</span><br><span class="line">httpd                 latest    a6ca7b52a415   2 weeks ago     168MB</span><br><span class="line">nginx                 latest    a6bd71f48f68   2 weeks ago     187MB</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231206202718157.png" alt="image-20231206202718157"></p>
<h2 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h2><h3 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="headerlink" title="什么是容器数据卷"></a>什么是容器数据卷</h3><p>docker的理念回顾</p>
<p>将应用和环境打包成一个镜像</p>
<p>如果数据都在容器中，那么我们容器一删除，数据就会丢失。==需求：数据可以持久化==</p>
<h3 id="使用数据卷"><a href="#使用数据卷" class="headerlink" title="使用数据卷"></a>使用数据卷</h3><ul>
<li>方式一：使用命令进行挂载</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -it -v 主机目录，容器目录</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用docker inspcet查看容器的具体信息</span></span><br><span class="line">docker inspect 容器id</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207084700871.png" alt="image-20231207084700871"></p>
<blockquote>
<p>宿主机内创建的文件 容器内部也能看到</p>
</blockquote>
<p>效果：</p>
<p><strong>容器内部：</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/WaitAyaka/wait-ayaka-pictures/raw/master/image-20231207084937247.png" alt="image-20231207084937247"></p>
<p><strong>宿主机：</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207085027544.png" alt="image-20231207085027544"></p>
<h2 id="部署MySQL"><a href="#部署MySQL" class="headerlink" title="部署MySQL"></a>部署MySQL</h2><h3 id="获取镜像"><a href="#获取镜像" class="headerlink" title="获取镜像"></a>获取镜像</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s home]# docker pull mysql:5.7</span><br></pre></td></tr></table></figure>
<h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s home]# docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7 </span><br><span class="line"></span><br><span class="line">-d   后台运行</span><br><span class="line">-v   卷挂载</span><br><span class="line">-p   端口映射</span><br><span class="line">-e   环境配置</span><br><span class="line">--name  容器名字</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动成功之后，在本地使用sqlyog来测试一下</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sqlyog-连接到服务器的3310---3310和容器内的3306端口的映射，整个时候我们就可以脸上了</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在本地测试创建一个数据库 查看一下映射的路径</span></span><br><span class="line">[root@k8s home]# ls /home/mysql/data/</span><br><span class="line">auto.cnf    client-cert.pem  ibdata1      ibtmp1      performance_schema  server-cert.pem  toto</span><br><span class="line">ca-key.pem  client-key.pem   ib_logfile0  mysql       private_key.pem     server-key.pem</span><br><span class="line">ca.pem      ib_buffer_pool   ib_logfile1  mysql.sock  public_key.pem      sys</span><br></pre></td></tr></table></figure>
<h3 id="具名挂载和匿名挂载"><a href="#具名挂载和匿名挂载" class="headerlink" title="具名挂载和匿名挂载"></a>具名挂载和匿名挂载</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">匿名挂载</span></span><br><span class="line">-v 容器内的路径</span><br><span class="line">docker run -d -P --name nginx1 -v /etc/nginx nginx</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看所有volume的情况</span></span><br><span class="line">[root@k8s home]# docker volume ls  </span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     0f7af9b1708ed85f3c19f990ccf2ac4fb11e609ca79ae6cd03fd8b2940725a2d</span><br><span class="line">local     1e3f80d7bef22963854d2fcb6b47cd1810a40b60beefb468a2183264ee20f5a0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上面这种就是匿名挂载</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用具名挂载</span></span><br><span class="line">[root@k8s home]# docker run -d -P --name NginxB -v juming-nginx:/etc/nginx nginx</span><br><span class="line">da62fa064716e96fe552c91bc8a3eb5e30f686b43c02b3edbf76b5f640758c3f</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">再次查看卷列表</span></span><br><span class="line">[root@k8s home]# docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     f531c23ff1b3320bc3467a899119ef3c868d4830a1ac345b27f9f0ddda7f3ffe</span><br><span class="line">local     juming-nginx</span><br></pre></td></tr></table></figure>
<h3 id="对应的路径"><a href="#对应的路径" class="headerlink" title="对应的路径"></a>对应的路径</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@k8s home]# docker volume inspect juming-nginx</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;CreatedAt&quot;: &quot;2023-12-06T20:30:22-05:00&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Labels&quot;: null,</span><br><span class="line">        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/juming-nginx/_data&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;juming-nginx&quot;,</span><br><span class="line">        &quot;Options&quot;: null,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><strong>所有的docker容器内的卷，没有指定目录的情况下，都在<code>/var/lib/docker/volumes/xxxx/_data</code></strong></p>
<p>通过具名股灾可用方便的找到我们的一个卷  大多数情况在使用的是<code>具名挂载</code></p>
<h3 id="区分具名、匿名挂载"><a href="#区分具名、匿名挂载" class="headerlink" title="区分具名、匿名挂载"></a>区分具名、匿名挂载</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-v 容器内路径   # 匿名挂载</span><br><span class="line">-v 卷名：容器内的路径   # 具名挂载</span><br><span class="line">-v /宿主机路径：容器内的路径  # 指定路径挂载</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/WaitAyaka/wait-ayaka-pictures/raw/master/image-20231207093818468.png" alt="image-20231207093818468"></p>
<h3 id="初识dockerfile"><a href="#初识dockerfile" class="headerlink" title="初识dockerfile"></a>初识dockerfile</h3><p>Dockerfile就是用来构建docker镜像的构建文件！</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#  创建一个dockerfile文件，名字可用随机，建议使用Dockerfile</span><br><span class="line"># 文件中的内容</span><br><span class="line">[root@k8s docker-test]# cat dockerfile1 </span><br><span class="line">FROM  centos</span><br><span class="line"></span><br><span class="line">VOLUME [&quot;volume01&quot;,&quot;volume02&quot;]</span><br><span class="line"></span><br><span class="line">CMD echo &quot;----end----&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"># 这里的每个命令就是镜像的一层</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207094909141.png" alt="image-20231207094909141"></p>
<h4 id="使用构建的镜像创建容器"><a href="#使用构建的镜像创建容器" class="headerlink" title="使用构建的镜像创建容器"></a>使用构建的镜像创建容器</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s docker-test]# docker run -it bcb7b9d02259  bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">bcb7b9d02259为我们镜像的<span class="built_in">id</span></span></span><br><span class="line">REPOSITORY            TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">mycentos              1.0       bcb7b9d02259   2 years ago     231MB</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207095153112.png" alt="image-20231207095153112"></p>
<h4 id="测试目录同步"><a href="#测试目录同步" class="headerlink" title="测试目录同步"></a>测试目录同步</h4><p><strong>进入到volume2中 创建文件并保存</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@k8s docker-test]# docker exec -it 65b097a207f6 bash</span><br><span class="line">[root@65b097a207f6 /]# cd volume02</span><br><span class="line">[root@65b097a207f6 volume02]# mkdir toto</span><br><span class="line">[root@65b097a207f6 volume02]# touch index.txt</span><br><span class="line">[root@65b097a207f6 volume02]# read escape sequence</span><br><span class="line"># 按住ctrl+p+q退出并继续运行容器</span><br></pre></td></tr></table></figure>
<p><strong>查看容器信息 （查看宿主机默认的挂载目录）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@k8s _data]# docker inspect 65b097a207f6</span><br><span class="line"></span><br><span class="line">        &quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;volume&quot;,</span><br><span class="line">                &quot;Name&quot;: &quot;2ad3dd80f2261dee63ddd333ccfe0057a890ded085d58e2c050fd141d40dafe2&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/var/lib/docker/volumes/2ad3dd80f2261dee63ddd333ccfe0057a890ded085d58e2c050fd141d40dafe2/_data&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;volume02&quot;,</span><br><span class="line">                &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line"># </span><br><span class="line">查询到默认挂载的目录：/var/lib/docker/volumes/2ad3dd80f2261dee63ddd333ccfe0057a890ded085d58e2c050fd141d40dafe2/_data</span><br></pre></td></tr></table></figure>
<p><strong>进入默认挂载目录并查看目录内容</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@k8s docker-test]# cd /var/lib/docker/volumes/2ad3dd80f2261dee63ddd333ccfe0057a890ded085d58e2c050fd141d40dafe2/_data</span><br><span class="line"></span><br><span class="line">[root@k8s _data]# ls</span><br><span class="line">index.txt  toto</span><br><span class="line"># 同步成功</span><br></pre></td></tr></table></figure>
<h3 id="数据卷容器"><a href="#数据卷容器" class="headerlink" title="数据卷容器"></a>数据卷容器</h3><p>多个mysql同步数据  <strong>容器间的数据共享</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207100626194.png" alt="image-20231207100626194"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 启动三个容器 通过我们自己写的镜像启动</span><br></pre></td></tr></table></figure>
<ul>
<li>docker01</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/WaitAyaka/wait-ayaka-pictures/raw/master/image-20231207101041024.png" alt="image-20231207101041024"></p>
<ul>
<li>docker02</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207101342245.png" alt="image-20231207101342245"></p>
<ul>
<li>docker03 同步</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207102147050.png" alt="image-20231207102147050"></p>
<ul>
<li>docker01 同步</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207102227008.png" alt="image-20231207102227008"></p>
<ul>
<li>docker02 同步</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207102257809.png" alt="image-20231207102257809"></p>
<p><strong>同步成功</strong>   这样我们就实现了容器间的数据共享</p>
<p>当我们在docker1上创建了文件时 宿主机、docker02、3都能接收到这个文件  说明了<code>我们实现了容器间的数据共享</code>~</p>
<p><strong>docker02、03时绑定的docker01</strong> 但是docker01容器被kill掉时 <strong>docker02、03的数据依旧不会消失 ~</strong></p>
<p>因为<code>他们三个都绑定到了宿主机上</code> <code>只要宿主机上的文件还存在</code> 那么volumes01、02目录的内容就不会消失~</p>
<p><strong>实现多个mysql数据共享</strong></p>
<p>一、创建两个mysql容器 mysqlB绑定到mysqlA上</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker run -d -p 3311:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysqlA mysql:5.7</span><br><span class="line"></span><br><span class="line">[root@k8s ~]# docker run -d -p 3312:3306 --volumes-from mysqlA -e MYSQL_ROOT_PASSWORD=123456 --name mysqlB mysql:5.7c2c2bf254ad7c1e5b6ea56886cbe959fbe5ae07d5262d651d3509129cedad31a</span><br></pre></td></tr></table></figure>
<p>二、在MysqlA上创建数据库mariadb 并查看宿主机上的挂载目录</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/WaitAyaka/wait-ayaka-pictures/raw/master/image-20231207104032725.png" alt="image-20231207104032725"></p>
<p>三、在MysqlB上创建数据库postgresql并在宿主机上查看目录</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/21879/AppData/Roaming/Typora/typora-user-images/image-20231207104302194.png" alt="image-20231207104302194"></p>
<p>这样就实现了多个mysql的数据共享</p>
<hr>
<h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>dockerfile是用来构建docker镜像的文件！命令参数脚本！</p>
<p>构建步骤：</p>
<p>1、编写一个dockerfile文件</p>
<p>2、docker build构建成一个镜像</p>
<p>3、docker run 运行镜像</p>
<p>4、 docker push 发布镜像</p>
<h3 id="Docker构建过程"><a href="#Docker构建过程" class="headerlink" title="Docker构建过程"></a>Docker构建过程</h3><p>基础知识：</p>
<p>1、每个保留关键词（指令）都是必须大写字母</p>
<p>2、执行从上到下的顺序</p>
<p>3、 # 表示注释</p>
<p>4、 每一个指令都会创建提交一个新的镜像层并提交！</p>
<p>dockerfile是面向开发的，我们以后发布项目，做镜像，就需要编写dockerfile文件，这个文件十分简单</p>
<p>Docker镜像逐渐成为了企业交付的标准，必须要掌握。</p>
<p>Dockerfile：构建文件，定义了一切的步骤</p>
<p>DockerImages：通过dockerfile构建生成的一个镜像</p>
<p>Dockercontainer：容器就是镜像运行起来提供服务器</p>
<h3 id="Dockerfile的指令"><a href="#Dockerfile的指令" class="headerlink" title="Dockerfile的指令"></a>Dockerfile的指令</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">FROM          # 基础镜像，一切从这里开始构建</span><br><span class="line">MAINTAINER    # 维护者信息</span><br><span class="line">RUN      	# 镜像构建运行的命令</span><br><span class="line">ADD      	# 增加文件</span><br><span class="line">workdir       # 镜像的工作目录 </span><br><span class="line">VOLUME        # 镜像挂载目录</span><br><span class="line">EXPOSE    	# 申明端口</span><br><span class="line">CMD      	# 指定启动容器时运行的命令</span><br><span class="line">ENTRYPOINT    # 指定这个容器启动的时候要运行的命令，可用追加命令</span><br><span class="line">COPY      	# 类似ADD命令，将我们文件拷贝到镜像中</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="Users/21879/Documents/Downloads/nMzQji.png" alt="nMzQji"></p>
<blockquote>
<p> 创建一个自己的centos</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s centos]# cat Dockerfile </span><br><span class="line">FROM centos:7</span><br><span class="line">MAINTAINER ayaka&lt;2187988995@qq.com&gt;</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">RUN yum install -y vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"></span><br><span class="line">EXPOSE 80</span><br><span class="line"></span><br><span class="line">CMD echo $MYPATH</span><br><span class="line">CMD echo &quot;----end----&quot;</span><br><span class="line">CMD /bin/bash</span><br></pre></td></tr></table></figure>
<p>通过文件构建镜像</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s centos]# docker build -f Dockerfile -t centos-yum:1.0 .</span><br><span class="line"></span><br><span class="line">[root@k8s centos]# docker images</span><br><span class="line">REPOSITORY            TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">centos-yum            1.0       b7e760e76050   2 hours ago     687MB</span><br></pre></td></tr></table></figure>
<p>测试运行</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s centos]# docker run -it --name centos01 centos-yum:1.0</span><br><span class="line">/usr/local</span><br><span class="line">----end----</span><br><span class="line">[root@075633642f19 local]# </span><br><span class="line">[root@075633642f19 local]# ls</span><br><span class="line">bin  etc  games  include  lib  lib64  libexec  sbin  share  src</span><br></pre></td></tr></table></figure>
<p>测试vim和ifconfig命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@075633642f19 local]# ifconfig </span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.3  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:ac:11:00:03  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 17  bytes 2144 (2.0 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">[root@075633642f19 local]# </span><br></pre></td></tr></table></figure>
<p>查看镜像构建过程</p>
<p>Docker history</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s centos]# docker history centos-yum:1.0 </span><br><span class="line">IMAGE          CREATED       CREATED BY                                       SIZE      COMMENT</span><br><span class="line">b7e760e76050   2 hours ago   CMD [&quot;/bin/bash&quot; &quot;-c&quot; &quot;echo $MYPATH &amp;&amp; echo …   0B        buildkit.dockerfile.v0</span><br><span class="line">&lt;missing&gt;      2 hours ago   EXPOSE map[80/tcp:&#123;&#125;]                            0B        buildkit.dockerfile.v0</span><br><span class="line">&lt;missing&gt;      2 hours ago   RUN /bin/sh -c yum -y install net-tools # bu…   198MB     buildkit.dockerfile.v0</span><br><span class="line">&lt;missing&gt;      2 hours ago   RUN /bin/sh -c yum install -y vim # buildkit     285MB     buildkit.dockerfile.v0</span><br><span class="line">&lt;missing&gt;      3 hours ago   WORKDIR /usr/local                               0B        buildkit.dockerfile.v0</span><br><span class="line">&lt;missing&gt;      3 hours ago   ENV MYPATH=/usr/local                            0B        buildkit.dockerfile.v0</span><br><span class="line">&lt;missing&gt;      3 hours ago   MAINTAINER ayaka&lt;2187988995@qq.com&gt;              0B        buildkit.dockerfile.v0</span><br><span class="line">&lt;missing&gt;      2 years ago   /bin/sh -c #(nop)  CMD [&quot;/bin/bash&quot;]             0B        </span><br><span class="line">&lt;missing&gt;      2 years ago   /bin/sh -c #(nop)  LABEL org.label-schema.sc…   0B        </span><br><span class="line">&lt;missing&gt;      2 years ago   /bin/sh -c #(nop) ADD file:b3ebbe8bd304723d4…   204MB  </span><br></pre></td></tr></table></figure>
<h3 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h3><p>Dockerfile中的CMD的运用技巧</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建一个Dockerfile 并在其中添加CMD参数命令 指定进入容器时 运行<span class="built_in">ls</span> -a命令</span></span><br><span class="line">[root@k8s centos]# vim dockerfile-cmd-test</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">构建镜像</span></span><br><span class="line">[root@k8s centos]# docker build -f dockerfile-cmd-test -t cmdtest:1.0 .</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动容器</span></span><br><span class="line">[root@k8s centos]# docker run -it cmdtest:1.0 </span><br><span class="line">.  ..  .dockerenv  bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr var</span><br><span class="line"></span><br><span class="line">Dockerfile内容</span><br><span class="line">[root@k8s centos]# cat dockerfile-cmd-test </span><br><span class="line">FROM centos</span><br><span class="line">CMD [&quot;ls&quot;,&quot;-a&quot;]</span><br></pre></td></tr></table></figure>
<p><strong>ENTRYPORT</strong></p>
<p>Dockerfile中ENTRYPOINT的运用技巧</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">创建容器</span><br><span class="line">[root@k8s centos]# docker run -it entrypoint:1 </span><br><span class="line">.  ..  .dockerenv  bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line"></span><br><span class="line">构建镜像</span><br><span class="line">[root@k8s centos]# docker build -f dockerfile-cmd-entrypoint -t entrypoint:1 .</span><br><span class="line"></span><br><span class="line">Dockerfile中的内容</span><br><span class="line">FROM centos</span><br><span class="line">ENTRYPOINT [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们的追加命令，时可以直接评价在ENTRYPOINT追加</span></span><br><span class="line">[root@k8s centos]# docker run entrypoint:1 -l</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x    1 root root    6 Dec  7 06:41 .</span><br><span class="line">drwxr-xr-x    1 root root    6 Dec  7 06:41 ..</span><br><span class="line">-rwxr-xr-x    1 root root    0 Dec  7 06:41 .dockerenv</span><br><span class="line">lrwxrwxrwx.   1 root root    7 Nov  3  2020 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x    5 root root  340 Dec  7 06:41 dev</span><br><span class="line">drwxr-xr-x    1 root root   66 Dec  7 06:41 etc</span><br><span class="line">drwxr-xr-x.   2 root root    6 Nov  3  2020 home</span><br><span class="line">lrwxrwxrwx.   1 root root    7 Nov  3  2020 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx.   1 root root    9 Nov  3  2020 lib64 -&gt; usr/lib64</span><br><span class="line">drwx------.   2 root root    6 Sep 15  2021 lost+found</span><br><span class="line">drwxr-xr-x.   2 root root    6 Nov  3  2020 media</span><br><span class="line">drwxr-xr-x.   2 root root    6 Nov  3  2020 mnt</span><br><span class="line">drwxr-xr-x.   2 root root    6 Nov  3  2020 opt</span><br><span class="line">dr-xr-xr-x  429 root root    0 Dec  7 06:41 proc</span><br><span class="line">dr-xr-x---.   2 root root  162 Sep 15  2021 root</span><br><span class="line">drwxr-xr-x.  11 root root  163 Sep 15  2021 run</span><br><span class="line">lrwxrwxrwx.   1 root root    8 Nov  3  2020 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x.   2 root root    6 Nov  3  2020 srv</span><br><span class="line">dr-xr-xr-x   13 root root    0 Dec  7 06:41 sys</span><br><span class="line">drwxrwxrwt.   7 root root  171 Sep 15  2021 tmp</span><br><span class="line">drwxr-xr-x.  12 root root  144 Sep 15  2021 usr</span><br><span class="line">drwxr-xr-x.  20 root root 4096 Sep 15  2021 var</span><br></pre></td></tr></table></figure>
<h2 id="构建httpd镜像"><a href="#构建httpd镜像" class="headerlink" title="构建httpd镜像"></a>构建httpd镜像</h2><p>一、创建文件夹并编辑Dockerfile文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">FROM rockylinux:9.1</span><br><span class="line">MAINTAINER ayaka</span><br><span class="line"></span><br><span class="line">COPY yum.repo /usr/local</span><br><span class="line">COPY httpd.conf /usr/local</span><br><span class="line"></span><br><span class="line">RUN rm -rf /etc/yum.repos.d/* &amp;&amp; \</span><br><span class="line">    cp /usr/local/yum.repo /etc/yum.repos.d/ &amp;&amp; \</span><br><span class="line">    yum makecache &amp;&amp; \</span><br><span class="line">    yum install -y httpd* &amp;&amp; \</span><br><span class="line">    echo &quot;hello world&quot; &gt; /var/www/html/index.html &amp;&amp; \</span><br><span class="line">    mv -f /usr/local/httpd.conf /etc/httpd/conf/</span><br><span class="line"></span><br><span class="line">CMD [&quot;/usr/sbin/httpd&quot;, &quot;-D&quot;, &quot;FOREGROUND&quot;]</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">构建镜像</span></span><br><span class="line">[root@k8s tomcat]# docker build -t centos-web:1.0 .</span><br></pre></td></tr></table></figure>
<p><strong>查看镜像列表</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@k8s tomcat]# docker images</span><br><span class="line">REPOSITORY            TAG       IMAGE ID       CREATED             SIZE</span><br><span class="line">centos-web            1.0       6e46f461db6c   14 minutes ago      278MB</span><br></pre></td></tr></table></figure>
<p><strong>创建容器</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s tomcat]# docker run -itd --name webA -p 8001:80 centos-web:1.0 </span><br><span class="line">55b24aaec93d01e68cbfb286d854d9758348c9fcf4aeb4496c195f714bd793ca</span><br></pre></td></tr></table></figure>
<p><strong>访问8001端口</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@k8s tomcat]# curl localhost:8001</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>
<h3 id="Rocky容器内启动Apche-Httpd服务"><a href="#Rocky容器内启动Apche-Httpd服务" class="headerlink" title="Rocky容器内启动Apche Httpd服务"></a>Rocky容器内启动Apche Httpd服务</h3><p><strong>利用镜像创建容器</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# docker run -it --name web1 -p 1234:80 --privileged=true --restart=always rockylinux:9.1 bash</span><br><span class="line">828e1c7387b2c692e82f9d96402779325e824bf34505b94869ae742a9681a576</span><br></pre></td></tr></table></figure>
<p><strong>配置好yum源</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@daa98bede414 /]# cat /etc/yum.repos.d/yum.repo </span><br><span class="line">[Install-Media]</span><br><span class="line">name=RockyLinux9.1</span><br><span class="line">baseurl=http://192.168.123.101/cdrom/AppStream</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[Install-BaseOS]</span><br><span class="line">name=RockyLinux9.1</span><br><span class="line">baseurl=http://192.168.123.101/cdrom/BaseOS</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line"># 更新本地源缓存</span><br><span class="line">[root@daa98bede414 /]# yum makecache</span><br><span class="line">RockyLinux9.1                                                                                               4.0 MB/s | 4.1 kB     00:00    </span><br><span class="line">RockyLinux9.1                                                                                               3.6 MB/s | 3.6 kB     00:00    </span><br><span class="line">Metadata cache created.</span><br></pre></td></tr></table></figure>
<p><strong>下载软件包并进行配置</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载软件包和vim工具</span></span><br><span class="line">[root@daa98bede414 /]# yum install -y httpd* vim</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编辑主页内容</span></span><br><span class="line">[root@daa98bede414 /]# echo &quot;Hello World&quot; &gt; /var/www/html/index.html</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进入配置文件配置虚拟主机</span></span><br><span class="line">[root@k8s ~]#  tail -10 /etc/httpd/conf/httpd.conf </span><br><span class="line">IncludeOptional conf.d/*.conf</span><br><span class="line">&lt;Virtualhost *:80&gt;</span><br><span class="line">        ServerName localhost</span><br><span class="line">        DocumentRoot &quot;/var/www/html&quot;</span><br><span class="line">        &lt;Directory &quot;/var/www/html&quot;&gt;</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">        &lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure>
<p><strong>重启httpd</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@daa98bede414 /]# /usr/sbin/httpd </span><br></pre></td></tr></table></figure>
<p><strong>退出到宿主机并访问1234端口</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@k8s ~]# curl localhost:1234</span><br><span class="line">Hello World</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://waitayaka.github.io">WaitAyaka</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://waitayaka.github.io/2024/04/30/Docker%E6%95%99%E7%A8%8B/">https://waitayaka.github.io/2024/04/30/Docker教程/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://WaitAyaka.github.io" target="_blank">WaitAyaka</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/Tags/Linux/">Linux</a><a class="post-meta__tags" href="/Tags/Docker/">Docker</a><a class="post-meta__tags" href="/Tags/Kubernetes/">Kubernetes</a></div><div class="post_share"><div class="social-share" data-image="/img/docker.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/zhifubao.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/zhifubao.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/05/14/2022%E5%B9%B4%E4%B8%AD%E8%81%8C%E7%BB%84%E5%85%A8%E5%9B%BD%E8%81%8C%E4%B8%9A%E9%99%A2%E6%A0%A1%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E7%BD%91%E7%BB%9C%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%BA%94%E7%94%A8%E8%B5%9B%E9%A1%B9%EF%BC%88%E4%BA%A4%E6%8D%A2%E8%A7%A3%E6%B3%95%EF%BC%89/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/1297318.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">2022年中职组全国职业院校技能大赛网络搭建与应用赛项（交换解法）</div></div></a></div><div class="next-post pull-right"><a href="/2024/04/30/Postfix-Dovecot%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A0%B7%E9%A2%98/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/ChinaSkills.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Postfix&amp;Dovecot邮件服务器样题</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/04/16/Ansible%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4/" title="Ansible自动化运维服务器的部署"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/ansible.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-04-30</div><div class="title">Ansible自动化运维服务器的部署</div></div></a></div><div><a href="/2024/04/16/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="FTP服务器的配置与管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/ftp.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-04-30</div><div class="title">FTP服务器的配置与管理</div></div></a></div><div><a href="/2024/04/30/Postfix-Dovecot%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A0%B7%E9%A2%98/" title="Postfix&amp;Dovecot邮件服务器样题"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/ChinaSkills.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-04-30</div><div class="title">Postfix&amp;Dovecot邮件服务器样题</div></div></a></div><div><a href="/2024/04/24/KVM%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA/" title="2023年网络建设与运维KVM创建虚拟机的全过程"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/ChinaSkills.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-04-30</div><div class="title">2023年网络建设与运维KVM创建虚拟机的全过程</div></div></a></div><div><a href="/2024/04/30/Samba%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%9F%BA%E7%A1%80/" title="保姆级教学 Samba服务器的配置与管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/samba1.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-04-30</div><div class="title">保姆级教学 Samba服务器的配置与管理</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker"><span class="toc-text">*Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E5%87%BA%E7%8E%B0%EF%BC%9F"><span class="toc-text">Docker为什么会出现？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E7%9A%84%E5%8E%86%E5%8F%B2"><span class="toc-text">Docker的历史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E8%83%BD%E5%B9%B2%E5%98%9B"><span class="toc-text">Docker能干嘛</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E5%AE%89%E8%A3%85"><span class="toc-text">Docker安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90"><span class="toc-text">Docker的基本组成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Docker-%EF%BC%88%E7%BD%91%E7%BB%9C%E6%BA%90%EF%BC%89"><span class="toc-text">安装Docker （网络源）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81-%E5%8D%B8%E8%BD%BDDocker%E7%9A%84%E6%97%A7%E7%89%88%E6%9C%AC"><span class="toc-text">1、 卸载Docker的旧版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81-%E5%AE%89%E8%A3%85%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83"><span class="toc-text">2、 安装基本环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E8%AE%BE%E7%BD%AE%E9%95%9C%E5%83%8F%E7%9A%84%E4%BB%93%E5%BA%93"><span class="toc-text">3、设置镜像的仓库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E6%9B%B4%E6%96%B0yum%E6%BA%90%E5%B9%B6%E5%AE%89%E8%A3%85docker-ce"><span class="toc-text">4、更新yum源并安装docker-ce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81%E5%90%AF%E5%8A%A8docker"><span class="toc-text">5、启动docker</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81-%E6%9F%A5%E7%9C%8Bdocker-version-%E6%9F%A5%E7%9C%8B%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F"><span class="toc-text">6、 查看docker version 查看是否安装成功</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81-%E8%BF%90%E8%A1%8Chello-world"><span class="toc-text">7、 运行hello world</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E3%80%81-%E6%9F%A5%E7%9C%8Bhello-world%E9%95%9C%E5%83%8F"><span class="toc-text">8、 查看hello-world镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%86%E8%A7%A3%EF%BC%9A%E5%8D%B8%E8%BD%BDdocker"><span class="toc-text">了解：卸载docker</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A0%E9%80%9F"><span class="toc-text">配置阿里云加速</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BEHelloWorld%E6%B5%81%E7%A8%8B"><span class="toc-text">回顾HelloWorld流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-text">底层原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E7%9A%84%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">Docker的常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4"><span class="toc-text">帮助命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4"><span class="toc-text">镜像命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">容器命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%85%B6%E5%AE%83%E5%91%BD%E4%BB%A4"><span class="toc-text">常用其它命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E5%AE%89%E8%A3%85Nginx"><span class="toc-text">Docker安装Nginx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E5%AE%89%E8%A3%85tomcat"><span class="toc-text">docker安装tomcat</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%B8%8B%E8%BD%BDtomcat"><span class="toc-text">一、下载tomcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%A3%80%E6%9F%A5%E9%95%9C%E5%83%8F"><span class="toc-text">二、检查镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%90%AF%E5%8A%A8%E8%BF%90%E8%A1%8Ctomcat"><span class="toc-text">三、启动运行tomcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%B5%8B%E8%AF%95%E8%AE%BF%E9%97%AEtomcat"><span class="toc-text">四、测试访问tomcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E8%BF%9B%E5%85%A5tomcat%E5%AE%B9%E5%99%A8"><span class="toc-text">五、进入tomcat容器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2es-kibana"><span class="toc-text">部署es+kibana</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8elasticsearch"><span class="toc-text">启动elasticsearch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-stats%E6%9F%A5%E7%9C%8Bcpu%E7%8A%B6%E6%80%81"><span class="toc-text">docker stats查看cpu状态</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-text">可视化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E9%95%9C%E5%83%8F%E8%AE%B2%E8%A7%A3"><span class="toc-text">Docker镜像讲解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">镜像是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86"><span class="toc-text">Docker镜像加载原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B1%82%E7%90%86%E8%A7%A3"><span class="toc-text">分层理解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#commit%E9%95%9C%E5%83%8F"><span class="toc-text">commit镜像</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-text">容器数据卷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-text">什么是容器数据卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-text">使用数据卷</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2MySQL"><span class="toc-text">部署MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%95%9C%E5%83%8F"><span class="toc-text">获取镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1"><span class="toc-text">启动服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E5%90%8D%E6%8C%82%E8%BD%BD%E5%92%8C%E5%8C%BF%E5%90%8D%E6%8C%82%E8%BD%BD"><span class="toc-text">具名挂载和匿名挂载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E5%BA%94%E7%9A%84%E8%B7%AF%E5%BE%84"><span class="toc-text">对应的路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%BA%E5%88%86%E5%85%B7%E5%90%8D%E3%80%81%E5%8C%BF%E5%90%8D%E6%8C%82%E8%BD%BD"><span class="toc-text">区分具名、匿名挂载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E8%AF%86dockerfile"><span class="toc-text">初识dockerfile</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%9E%84%E5%BB%BA%E7%9A%84%E9%95%9C%E5%83%8F%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8"><span class="toc-text">使用构建的镜像创建容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%9B%AE%E5%BD%95%E5%90%8C%E6%AD%A5"><span class="toc-text">测试目录同步</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8"><span class="toc-text">数据卷容器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dockerfile"><span class="toc-text">Dockerfile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="toc-text">Docker构建过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dockerfile%E7%9A%84%E6%8C%87%E4%BB%A4"><span class="toc-text">Dockerfile的指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMD"><span class="toc-text">CMD</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E5%BB%BAhttpd%E9%95%9C%E5%83%8F"><span class="toc-text">构建httpd镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rocky%E5%AE%B9%E5%99%A8%E5%86%85%E5%90%AF%E5%8A%A8Apche-Httpd%E6%9C%8D%E5%8A%A1"><span class="toc-text">Rocky容器内启动Apche Httpd服务</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By WaitAyaka</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.twikoo.waitayaka.top/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.twikoo.waitayaka.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script async src="https://npm.elemecdn.com/tzy-blog/lib/js/other/sakura.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>